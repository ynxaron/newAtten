<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Student Attendance Dashboard</title>

        <!-- Bootstrap 5 CDN -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />

        <!-- Font Awesome for icons -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="scripts/sidebar_button.js"></script>
        <script src="scripts/header_script.js"></script>
        <style>
            body {
                background: #f5f7ff;
                font-family: "Segoe UI", sans-serif;
            }
            .sidebar {
                background: #fff;
                height: 100vh;
                padding: 1.5rem;
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.05);
            }
            .sidebar .nav-link {
                color: #555;
                margin: 0.5rem 0;
            }
            .sidebar .nav-link:hover {
                background: #e8ecff;
                border-radius: 8px;
            }
            .stat-box {
                background: #fff;
                padding: 1rem;
                border-radius: 10px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
                text-align: center;
            }
            .chart-box {
                background: #fff;
                border-radius: 10px;
                padding: 1rem;
                margin-bottom: 2rem;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            }
            .right-panel {
                background: #fff;
                padding: 1rem;
                border-radius: 10px;
                height: 100%;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
            }
            .calendar td {
                text-align: center;
                padding: 0.5rem;
            }
            .calendar .today {
                background-color: #e0e7ff;
                border-radius: 50%;
            }
            .gallery-img {
                width: 50px;
                height: 50px;
                object-fit: cover;
                border-radius: 8px;
            }

            .calendar {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 6px;
            }

            .calendar .day-box {
                height: 100px;
                border-radius: 8px;
                color: white;
                display: flex;
                justify-content: center;
                align-items: center;
                font-weight: 500;
                font-size: 0.9rem;
                transition: background-color 0.3s;
            }
        </style>
    </head>

    <body>
        <div class="container-fluid p-0 m-0">
            <div class="row">
                <!-- Sidebar -->
                <div
                    class="sidebar d-flex flex-column position-fixed bg-white p-3"
                    id="sidebar"
                    style="
                        top: 0;
                        left: 0;
                        height: 100vh;
                        width: 260px;
                        z-index: 1030;
                    "
                >
                    <div class="mb-5 text-center">
                        <img
                            src="assets/djubo-cropped.png"
                            alt="DJUBO Logo"
                            style="max-width: 100%; height: 85px"
                        />
                    </div>

                    <nav class="nav flex-column">
                        <a
                            id="checkin-btn"
                            class="nav-link px-3 py-2 rounded text-white mb-2"
                            style="background-color: #825995"
                            href="#"
                        >
                            <i class="fas fa-clipboard-check me-2"></i>
                            <strong>CHECK IN</strong>
                        </a>

                        <a
                            id="checkout-btn"
                            class="nav-link px-3 py-2 rounded text-white mb-5"
                            style="background-color: #825995"
                            href="#"
                        >
                            <i class="fas fa-lock me-2"></i>
                            <strong>CHECK OUT</strong>
                        </a>

                        <a
                            id="break-btn"
                            class="nav-link px-3 py-2 rounded text-white mb-5"
                            style="background-color: #825995"
                            href="#"
                        >
                            <i class="fas fa-mug-hot me-2"></i>
                            <strong>BREAK</strong>
                        </a>

                        <hr style="height: 10px" />

                        <a
                            class="nav-link"
                            id="refresh-btn"
                            href="#"
                            target="_blank"
                        >
                            <i class="fas fa-rotate-right me-2"></i>Refresh
                        </a>

                        <a
                            class="nav-link"
                            href="localhost:4500/settings.html"
                            ,
                            target="_blank"
                        >
                            <i class="fas fa-cog me-2"></i>Settings
                        </a>

                        <a class="nav-link" href="localhost:4500/login.html">
                            <i class="fas fa-sign-out-alt me-2"></i>Log Out
                        </a>
                    </nav>

                    <div class="mt-auto text-center">
                        <img
                            src="assets/profile_cropped.png"
                            class="rounded-circle mb-2"
                            style="width: 60px; height: 60px"
                        />
                        <p class="mb-0 fw-bold" id="username-display">
                            Loading...
                        </p>
                        <small>Developer</small>
                    </div>
                </div>
                <!-- Sidebar-->
                <!-- Main Dashboard -->
                <div class="col p-4" style="margin-left: 260px">
                    <!-- Header -->
                    <div
                        class="d-flex justify-content-between align-items-center mb-4"
                    >
                        <div class="d-flex">
                            <span
                                id="current-time"
                                style="
                                    font-size: 2.25rem;
                                    font-weight: 900;
                                    color: darkgray;
                                    margin-left: 40px;
                                    margin-right: 30px;
                                "
                            ></span>

                            <h1 class="fw-bold" style="padding-top: 4px">
                                <span id="username">...</span>
                            </h1>
                        </div>

                        <div class="d-flex align-items-center gap-3">
                            <i
                                class="fas fa-rotate-right fs-5 text-secondary"
                                style="cursor: pointer; margin-right: 20px"
                            ></i>

                            <a href="settings.html">
                                <i
                                    class="fas fa-cog fs-5 text-secondary"
                                    style="cursor: pointer; margin-right: 20px"
                                ></i>
                            </a>

                            <img
                                src="assets/profile_cropped.png"
                                alt="Profile"
                                class="rounded-circle"
                                style="
                                    width: 40px;
                                    height: 40px;
                                    object-fit: cover;
                                "
                            />
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-3">
                            <div class="stat-box">
                                <h4>42h</h4>
                                <small>Total Leaves Taken</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box">
                                <h4>83h</h4>
                                <small>Total Leaves Left</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box">
                                <h4>100h</h4>
                                <small>Paid Overtime</small>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-box">
                                <h4>25d</h4>
                                <small>Total Absents</small>
                            </div>
                        </div>
                    </div>

                    <div class="mt-5 mb-4">
                        <h4><strong>Heat Map</strong></h4>
                        <div class="calendar" id="work-hours-calendar"></div>
                    </div>

                    <!-- Charts -->

                    <div class="chart-box">
                        <h4><strong>Hours by Week</strong></h4>
                        <canvas id="barChart"></canvas>
                    </div>

                    <div class="chart-box mb-4">
                        <h4><strong>Hours By Month</strong></h4>
                        <canvas id="lineChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart.js Scripts -->
        <script>
            // Line Chart (Attendance Overview)
            new Chart(document.getElementById("lineChart"), {
                type: "line",
                data: {
                    labels: [
                        "Jan",
                        "Feb",
                        "Mar",
                        "Apr",
                        "May",
                        "Jun",
                        "Jul",
                        "Aug",
                        "Sec",
                        "Oct",
                        "Nov",
                        "Dec",
                    ],
                    datasets: [
                        {
                            label: "Attendance",
                            data: [
                                51, 40, 40, 52, 45, 39, 54, 40, 39, 50, 30, 25,
                            ],
                            backgroundColor: "rgba(124, 86, 247, 0.2)",
                            borderColor: "rgba(124, 86, 247, 1)",
                            tension: 0.3,
                            fill: true,
                        },
                    ],
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } },
                },
            });

            // Bar Chart (Attendance by Class)
            new Chart(document.getElementById("barChart"), {
                type: "bar",
                data: {
                    labels: [
                        "Monday",
                        "Tuesday",
                        "Wednusday",
                        "Thursday",
                        "Friday",
                    ],
                    datasets: [
                        {
                            label: "Students",
                            data: [5, 7, 4, 7, 5],
                            backgroundColor: "rgba(124, 86, 247, 0.7)",
                        },
                    ],
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: true } },
                },
            });

            const workHours = [
                0, 2, 5, 6, 4, 8, 7, 9, 3, 1, 0, 5, 8, 6, 7, 2, 4, 6, 9, 10, 8,
                5, 3, 1, 0, 7, 9, 6, 4, 2,
            ];

            const weekdays = ["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"];
            const $calendar = $("#work-hours-calendar");

            $.each(workHours, function (index, hours) {
                const lightness = 100 - hours * 7;
                const dayNum = index + 1;
                const weekday = weekdays[index % 7];

                const $box = $("<div></div>", {
                    class: "day-box",
                    css: {
                        backgroundColor: `hsl(270, 60%, ${lightness}%)`,
                        color: lightness > 75 ? "#333" : "#fff",
                        position: "relative", // needed for absolute children
                        padding: "12px",
                        textAlign: "center",
                        fontWeight: "bold",
                    },
                });

                const $dayNum = $("<div></div>", {
                    text: dayNum,
                    css: {
                        fontSize: "24px",
                        marginBottom: "8px",
                    },
                });

                const $weekday = $("<div></div>", {
                    text: weekday,
                    css: {
                        fontSize: "12px",
                        position: "absolute",
                        bottom: "4px",
                        right: "6px",
                    },
                });

                $box.append($dayNum).append($weekday);
                $calendar.append($box);
            });
        </script>
    </body>
</html>
